<html><head><base href="https://ecobot.earth/" />
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EcoBot - Tu Asistente de Vida Sostenible con Voz</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #e8f5e9;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
  }
  .chat-container {
    width: 100%;
    max-width: 400px;
    background-color: #ffffff;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    overflow: hidden;
    margin-bottom: 20px;
  }
  .chat-header {
    background-color: #4caf50;
    color: white;
    padding: 15px;
    font-size: 18px;
    font-weight: bold;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .language-toggle, .voice-toggle {
    background: none;
    border: none;
    color: white;
    cursor: pointer;
    font-size: 14px;
    margin-left: 10px;
  }
  .chat-messages {
    height: 400px;
    overflow-y: auto;
    padding: 15px;
  }
  .message {
    margin-bottom: 15px;
    display: flex;
    flex-direction: column;
  }
  .bot-message {
    align-items: flex-start;
  }
  .user-message {
    align-items: flex-end;
  }
  .message-content {
    max-width: 80%;
    padding: 10px;
    border-radius: 15px;
  }
  .bot-message .message-content {
    background-color: #e0f2f1;
  }
  .user-message .message-content {
    background-color: #4caf50;
    color: white;
  }
  .chat-input {
    display: flex;
    padding: 15px;
    background-color: #f1f8e9;
  }
  #user-input {
    flex-grow: 1;
    padding: 10px;
    border: none;
    border-radius: 20px;
    outline: none;
  }
  #send-button, #voice-input-button {
    background-color: #4caf50;
    color: white;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    margin-left: 10px;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  #send-button:hover, #voice-input-button:hover {
    background-color: #45a049;
  }
  .feature-buttons {
    display: flex;
    justify-content: space-around;
    padding: 10px;
    background-color: #c8e6c9;
  }
  .feature-button {
    background-color: #81c784;
    color: white;
    border: none;
    border-radius: 5px;
    padding: 8px 12px;
    cursor: pointer;
    font-size: 12px;
    transition: background-color 0.3s;
  }
  .feature-button:hover {
    background-color: #66bb6a;
  }
  .team-info {
    background-color: #a5d6a7;
    color: #1b5e20;
    padding: 15px;
    border-radius: 10px;
    text-align: center;
    margin-top: 20px;
    font-size: 14px;
    max-width: 400px;
  }
  .loading {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 40px;
  }
  .loading::after {
    content: "";
    width: 20px;
    height: 20px;
    border: 2px solid #4caf50;
    border-top: 2px solid transparent;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
</style>
</head>
<body>
  <div class="chat-container">
    <div class="chat-header">
      <span id="header-title">EcoBot</span>
      <div>
        <button class="voice-toggle" onclick="toggleVoice()" id="voice-toggle">ðŸ”‡</button>
        <button class="language-toggle" onclick="toggleLanguage()">EN/ES</button>
      </div>
    </div>
    <div class="chat-messages" id="chat-messages">
      <div class="message bot-message">
        <div class="message-content" id="welcome-message">
          Â¡Bienvenido a EcoBot! Estoy aquÃ­ para ayudarte a vivir una vida mÃ¡s sostenible y responder cualquier pregunta ecolÃ³gica que puedas tener. Â¿CÃ³mo puedo asistirte hoy?
        </div>
      </div>
    </div>
    <div class="feature-buttons">
      <button class="feature-button" onclick="triggerFeature('carbon')" id="carbon-button">Huella de Carbono</button>
      <button class="feature-button" onclick="triggerFeature('waste')" id="waste-button">Rastreador de Residuos</button>
      <button class="feature-button" onclick="triggerFeature('products')" id="products-button">Productos Eco</button>
    </div>
    <div class="chat-input">
      <input type="text" id="user-input" placeholder="Escribe tu mensaje...">
      <button id="voice-input-button" onclick="startVoiceInput()">ðŸŽ¤</button>
      <button id="send-button" onclick="sendMessage()">âž¤</button>
    </div>
  </div>

  <div class="team-info" id="team-info">
    Desarrollado con pasiÃ³n por el equipo EcoBot:<br>
    Geronimo Martinez, Mariana Sanchez y Tomas Rodriguez
  </div>

  <script>
    const chatMessages = document.getElementById('chat-messages');
    const userInput = document.getElementById('user-input');
    let currentLanguage = 'es';
    let voiceEnabled = false;
    let recognition;

    const searchApiUrl = 'https://api.duckduckgo.com/';

    async function performWebSearch(query) {
      const response = await fetch(`${searchApiUrl}?q=${encodeURIComponent(query)}&format=json`);
      const data = await response.json();
      return data.Abstract || data.RelatedTopics[0]?.Text || "No se encontraron resultados relevantes.";
    }

    const translations = {
      en: {
        welcome: "Welcome to EcoBot! I'm here to help you live a more sustainable life and answer any ecological questions you may have. How can I assist you today?",
        carbonFootprint: "Carbon Footprint",
        wasteTracker: "Waste Tracker",
        ecoProducts: "Eco Products",
        ecoResponse: "That's an interesting ecological question! While I don't have a specific answer, I can provide general information on sustainability topics. Could you please provide more context or specify a particular area of ecology you'd like to know about?",
        inputPlaceholder: "Type your message...",
        headerTitle: "EcoBot",
        carbonResponse: "To calculate your carbon footprint, I'll need some information about your lifestyle. Let's start with your average monthly electricity usage in kWh. Can you provide that?",
        wasteResponse: "Great! Let's track your waste. Can you tell me what types of waste you typically generate in a week? For example: plastic, paper, food waste, etc.",
        productsResponse: "I'd be happy to recommend some eco-friendly products! What category are you interested in? We have options for home, personal care, and more.",
        defaultResponse: "I'm searching for information about your question. Here's what I found:",
        carbonMessage: "Let's calculate your carbon footprint!",
        wasteMessage: "Time to track your waste and improve recycling!",
        productsMessage: "Looking for eco-friendly product recommendations?",
        teamInfo: "Developed with passion by the EcoBot team:<br>Geronimo Martinez, Mariana Sanchez, and Tomas Rodriguez",
        voiceInputPlaceholder: "Listening...",
        voiceNotSupported: "Voice input is not supported in your browser.",
        loading: "Processing your question..."
      },
      es: {
        welcome: "Â¡Bienvenido a EcoBot! Estoy aquÃ­ para ayudarte a vivir una vida mÃ¡s sostenible y responder cualquier pregunta ecolÃ³gica que puedas tener. Â¿CÃ³mo puedo asistirte hoy?",
        carbonFootprint: "Huella de Carbono",
        wasteTracker: "Rastreador de Residuos",
        ecoProducts: "Productos Eco",
        ecoResponse: "Â¡Esa es una pregunta ecolÃ³gica interesante! Aunque no tengo una respuesta especÃ­fica, puedo proporcionar informaciÃ³n general sobre temas de sostenibilidad. Â¿PodrÃ­as proporcionar mÃ¡s contexto o especificar un Ã¡rea particular de ecologÃ­a sobre la que te gustarÃ­a saber?",
        inputPlaceholder: "Escribe tu mensaje...",
        headerTitle: "EcoBot",
        carbonResponse: "Para calcular tu huella de carbono, necesitarÃ© informaciÃ³n sobre tu estilo de vida. Comencemos con tu consumo mensual promedio de electricidad en kWh. Â¿Puedes proporcionarme ese dato?",
        wasteResponse: "Â¡Genial! Vamos a rastrear tus residuos. Â¿Puedes decirme quÃ© tipos de residuos generas tÃ­picamente en una semana? Por ejemplo: plÃ¡stico, papel, residuos de alimentos, etc.",
        productsResponse: "Â¡EstarÃ© encantado de recomendarte algunos productos ecolÃ³gicos! Â¿En quÃ© categorÃ­a estÃ¡s interesado? Tenemos opciones para el hogar, cuidado personal y mÃ¡s.",
        defaultResponse: "Estoy buscando informaciÃ³n sobre tu pregunta. Esto es lo que encontrÃ©:",
        carbonMessage: "Â¡Vamos a calcular tu huella de carbono!",
        wasteMessage: "Â¡Es hora de rastrear tus residuos y mejorar el reciclaje!",
        productsMessage: "Â¿Buscas recomendaciones de productos ecolÃ³gicos?",
        teamInfo: "Desarrollado con pasiÃ³n por el equipo EcoBot:<br>Geronimo Martinez, Mariana Sanchez y Tomas Rodriguez",
        voiceInputPlaceholder: "Escuchando...",
        voiceNotSupported: "La entrada de voz no es compatible con tu navegador.",
        loading: "Procesando tu pregunta..."
      }
    };

    function addMessage(content, isUser = false) {
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
      messageDiv.innerHTML = `<div class="message-content">${content}</div>`;
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
      
      if (voiceEnabled && !isUser) {
        speak(content);
      }
    }

    async function sendMessage() {
      const message = userInput.value.trim();
      if (message) {
        addMessage(message, true);
        userInput.value = '';
        setTimeout(() => botResponse(message), 1000);
      }
    }

    async function botResponse(userMessage) {
      addMessage('<div class="loading">Procesando tu pregunta...</div>');
      let response = '';
      
      if (userMessage.toLowerCase().includes(translations[currentLanguage].carbonFootprint.toLowerCase())) {
        response = translations[currentLanguage].carbonResponse;
      } else if (userMessage.toLowerCase().includes(translations[currentLanguage].wasteTracker.toLowerCase())) {
        response = translations[currentLanguage].wasteResponse;
      } else if (userMessage.toLowerCase().includes(translations[currentLanguage].ecoProducts.toLowerCase())) {
        response = translations[currentLanguage].productsResponse;
      } else {
        response = await performWebSearch(userMessage);
        if (response === "No se encontraron resultados relevantes.") {
          response = translations[currentLanguage].defaultResponse;
        }
      }
      
      chatMessages.removeChild(chatMessages.lastChild);
      addMessage(response);
    }

    function triggerFeature(feature) {
      let message = '';
      switch(feature) {
        case 'carbon':
          message = translations[currentLanguage].carbonMessage;
          break;
        case 'waste':
          message = translations[currentLanguage].wasteMessage;
          break;
        case 'products':
          message = translations[currentLanguage].productsMessage;
          break;
      }
      addMessage(message, true);
      setTimeout(() => botResponse(message), 1000);
    }

    function toggleLanguage() {
      currentLanguage = currentLanguage === 'en' ? 'es' : 'en';
      updateLanguage();
    }

    function updateLanguage() {
      document.getElementById('welcome-message').textContent = translations[currentLanguage].welcome;
      document.getElementById('carbon-button').textContent = translations[currentLanguage].carbonFootprint;
      document.getElementById('waste-button').textContent = translations[currentLanguage].wasteTracker;
      document.getElementById('products-button').textContent = translations[currentLanguage].ecoProducts;
      document.getElementById('user-input').placeholder = translations[currentLanguage].inputPlaceholder;
      document.getElementById('header-title').textContent = translations[currentLanguage].headerTitle;
      document.getElementById('team-info').innerHTML = translations[currentLanguage].teamInfo;
    }

    function toggleVoice() {
      voiceEnabled = !voiceEnabled;
      document.getElementById('voice-toggle').textContent = voiceEnabled ? 'ðŸ”Š' : 'ðŸ”‡';
    }

    function speak(text) {
      if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = currentLanguage === 'en' ? 'en-US' : 'es-ES';
        speechSynthesis.speak(utterance);
      }
    }

    function startVoiceInput() {
      if ('webkitSpeechRecognition' in window) {
        recognition = new webkitSpeechRecognition();
        recognition.lang = currentLanguage === 'en' ? 'en-US' : 'es-ES';
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;

        recognition.start();
        userInput.placeholder = translations[currentLanguage].voiceInputPlaceholder;

        recognition.onresult = function(event) {
          const speechResult = event.results[0][0].transcript;
          userInput.value = speechResult;
          sendMessage();
        };

        recognition.onend = function() {
          userInput.placeholder = translations[currentLanguage].inputPlaceholder;
        };

        recognition.onerror = function(event) {
          console.error('Speech recognition error', event.error);
          userInput.placeholder = translations[currentLanguage].inputPlaceholder;
        };
      } else {
        alert(translations[currentLanguage].voiceNotSupported);
      }
    }

    userInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        sendMessage();
      }
    });

    updateLanguage();
  </script>
</body>
</html>